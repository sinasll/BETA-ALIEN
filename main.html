<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALIENS</title>
    <link rel="stylesheet" href="mainstyle.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="container">
        <img src="alien.png" alt="ALIENS Logo" class="logo">
        <div class="username" id="username">@username</div>
        <div class="score-box" id="score-box">
            <span id="score">0</span>
        </div>
    </div>
    <nav>
        <ul class="nav-bar">
            <li class="nav-item">
                <a href="tasks.html">
                    <i class="fas fa-bullseye" aria-hidden="true"></i>
                </a>
            </li>
            <li class="nav-item active">
                <a href="main.html">
                    <i class="fas fa-user" aria-hidden="true"></i>
                </a>
            </li>
            <li class="nav-item">
                <a href="friends.html">
                    <i class="fas fa-users" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            // Ensure the Telegram WebApp API is ready before accessing its data
            const telegram = window.Telegram.WebApp;

            telegram.onEvent("ready", function() {
                // Reference to username and score display elements
                const usernameDisplay = document.getElementById("username");
                const scoreDisplay = document.getElementById("score");

                // Get the user's Telegram username and ID from the initDataUnsafe object
                if (telegram.initDataUnsafe && telegram.initDataUnsafe.user) {
                    const telegramUser = telegram.initDataUnsafe.user;
                    const username = telegramUser.username ? `@${telegramUser.username}` : 'Unknown User';
                    const telegramUserId = telegramUser.id;

                    // Display the Telegram username
                    usernameDisplay.textContent = username;

                    // Calculate the account age based on a fixed Telegram ID creation date (for demo purposes)
                    // Assume Telegram IDs were first used on October 13, 2013
                    const TELEGRAM_START_DATE = new Date('2013-10-13');
                    const currentDate = new Date();

                    // Estimate the account creation date based on user ID
                    const userAccountCreationDate = new Date(TELEGRAM_START_DATE.getTime() + telegramUserId * 1000);

                    // Calculate how many days since the account was created
                    const oneDayInMs = 24 * 60 * 60 * 1000; // Milliseconds in a day
                    const accountAgeInDays = Math.floor((currentDate - userAccountCreationDate) / oneDayInMs);

                    // Calculate the score (10 points per day)
                    const score = accountAgeInDays * 10;

                    // Display the score
                    scoreDisplay.textContent = score;
                } else {
                    // Handle case when Telegram WebApp data isn't available
                    usernameDisplay.textContent = "Unknown User";
                    scoreDisplay.textContent = "0";
                }

                // Expand the WebApp interface to fit content
                telegram.expand();
            });
        });
    </script>
</body>
</html>
